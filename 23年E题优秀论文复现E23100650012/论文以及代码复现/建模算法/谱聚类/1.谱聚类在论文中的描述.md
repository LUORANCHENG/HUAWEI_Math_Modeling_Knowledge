# 谱聚类在论文中的描述

## 1. 摘要中的描述

问题二：问题 a 要求构建所有患者的水肿体积随时间的进展曲线。经过对数据的预分析，发现水肿体积和时间之间存在高度的非线性关系，故而考虑使用非线性模型进行拟合。但由于本文数据量较少，为了防止相关模型过拟合，对模型的相关参数进行了限制，并使用网格搜索 +K 则交叉验证的方法确定最终的模型参数.经过对比，决策树获得了最佳的效果，平均残差值为1838.8871。问题 b 是问题 a 的延申，需要在其基础上区分不同的人群。首先利用肘部法则，确定了最佳的患者类别为 3。随后，在问题 a 的基础上，选取了四种不同类型的聚类模型，分别是斯混合聚类，DBSCAN，BIRCH 和谱聚类。其中，谱聚类的平均轮廓系数为 0.4186，戴维森-堡丁指数为 0.8817，获得了最佳的效果，此外，还使用 t-SNE 方法对聚类效果进行了可视化。最终，结合问题 a 建立的拟合模型，输出了前100 个患者水肿体积真实值和曲线间的残差，经过测试，经过聚类后模型的残差值由原先的 1838.8871 降低到了 980.245。

## 2. 问题二建模与求解中的描述

### 2.1 问题 b 的建模与求解

基于上一问中的拟合结果可以看到，线性与非线性方法的拟合效果都不是最佳，由此可以发现以全体患者的水肿体积为因变量是不够合理的。因此在本问中，首先肘部法则来确定亚组的个数，然后根据得到的 k 值应用于 DBSCAN 聚类、高斯混合聚类、谱聚类和BIRCH 聚类四种无标签聚类方法上，由此形成了四种聚类结果。根据评价指标对这四种聚类结果进行判断，选择效果最优的一种聚类方案。为形成各亚组人群水肿体积随时间的变化曲线，在选择出的效果最优的聚类方案上使用上一问中应用的四种拟合模型。根据评价指标和可视化拟合结果选择最优的曲线作为本问的结果。最后依照曲线和真实值计算残差。

### 2.2 聚类模型的建立

首先利用肘部法则，确定了最佳的聚类数目为3。随后，为探究最佳的聚类模型，本文选取了四种不同类型的聚类模型，分别是原型聚类中的高斯混合聚类，密度聚类中的DBSCAN 方法，层次聚类中的 BIRCH 方法和谱聚类 (spectral clustering)。基于无标签的分析指标进行评估，包括平均轮廓指数和戴维森-堡丁指数。

### 2.3 谱聚类算法描述

谱聚类 (Spectral Clustering) 是基于图论的聚类方法，其主要思想是：基于数据集来构图，距离越近的顶点，边的权重越高；距离越远的顶点之间的边权重越低。对图进行切割，使其不同子图之间的边的权重尽可能低、而各子图内边的权重尽可能高，以此完成聚类。

### 2.4 聚类模型的结果展示

为了探究患者水肿体积随时间进展模式的个体差异，构建不同人群的水肿体积随时间进展曲线。我们利用聚类的思想进行解决。个体变量选择的是"表1"中全部个体属性，主要包括有"90天mRS"和"E-W"列的全部数据，其中，特殊处理了血压一列，处理为舒张压和收缩压，也删除了发病到首次检查的时间。

在本问中为患者分亚组时，亚组个数采用肘部法则进行确定。最后结果显示，类别数目为3时实现最优。因此，在本问中，将全部患者分为3个亚组。通过对聚类模型进行平均轮廓指数、戴维森-堡丁指数计算，结果显示谱聚类模型的聚类效果最佳，各聚类模型的评价指标如表10。

| 聚类模型   | 平均轮廓系数              | 戴维森-堡丁指数              |
|--------|---------------------|-----------------------|
| 高斯混合模型 | 0.36088872469998756 | 0.36088872469998756 数 |
| BIRCH  | 0.36668680501600653 | 1.0776920727383936    |
| DBSCAN | 0.3646180406886636  | 0.935247402786577     |
| 谱聚类    | 0.4148608849907156  | 0.8817655964481479    |

从可视化结果图可以看出，谱聚类将全体患者按照个体差异划分为三类，以红、绿、蓝三色进行区分。从图像上看，红色点内的数据除部分紧密外，整体比较分散，这说明，红色点类内相似度相对较小。从类间分布来看，绿色点与蓝色点距离更远，这说明绿色点与蓝色点在高维空间中的相似度较小，差异性更大。

### 2.5 有关亚组的分析

通过谱聚类获得了三个亚组，接下来详细介绍这三个亚组。为叙述方便和描述精确，将含 61、18、21 的类别分别命名为亚组 1、亚组 2、亚组 3。

## 3. 问题2d中的描述

结合问题 b 对全体患者使用无标签聚类方法，得到了聚类效果最好的谱聚类，根据聚类结果将全体患者分为三个亚组。在本问中，首先探究血肿体积与水肿体积之间的相关性，研究是否存在相关关系。然后以三个亚组的代表性患者(sub013,sub015,sub099)为例，探究血肿体积与水肿体积之间的关系。在相关性的探究中，血肿体积与水肿体积之间的相关性系数为 0.47。

## 总结

谱聚类在本研究中作为四种聚类方法之一，通过平均轮廓系数为 0.4186 和戴维森-堡丁指数为 0.8817 的优异表现，获得了最佳的聚类效果，成功将患者按照个体差异划分为三个亚组，为后续的水肿体积进展模式分析奠定了基础。 