# 数据预处理步骤

## 数据类型概述

数据分为**连续型数据**和**非连续型数据**：

- **连续型数据**：在某个区间内可以取任意值的变量，例如身高、体重、年龄等
- **非连续型数据**：只能取有限个值的变量，例如性别、民族、血型等

## Step 1. 去除唯一属性

唯一属性通常是一些 ID 属性，这些属性并不能刻画样本自身的分布规律，所以简单地删除这些属性即可。

## Step 2. 处理缺失值

### 缺失值处理的三种策略

1. **直接使用含有缺失值的特征**
2. **删除含有缺失值的特征**（该方法在包含缺失值的属性含有大量缺失值而仅仅包含极少量有效值时是有效的）
3. **缺失值补全**

### 常见的缺失值补全方法

常见方法包括：均值插补、同类均值插补、建模预测、高维映射、多重插补、极大似然估计、压缩感知和矩阵补全。

#### (1) 均值插补
- 如果样本属性的距离是可度量的，则使用该属性有效值的**平均值**来插补缺失的值
- 如果距离是不可度量的，则使用该属性有效值的**众数**来插补缺失的值

#### (2) 同类均值插补
首先将样本进行分类，然后以该类中样本的均值来插补缺失值。

#### (3) 建模预测
将缺失的属性作为预测目标来预测，将数据集按照是否含有特定属性的缺失值分为两类，利用现有的机器学习算法对待预测数据集的缺失值进行预测。

**该方法的根本缺陷：**
- 如果其他属性和缺失属性无关，则预测的结果毫无意义
- 若预测结果相当准确，则说明这个缺失属性是没必要纳入数据集中的
- 一般的情况是介于两者之间

#### (4) 高维映射
将属性映射到高维空间，采用独热码编码（one-hot）技术。将包含 K 个离散取值范围的属性值扩展为 K+1 个属性值，若该属性值缺失，则扩展后的第 K+1 个属性值置为 1。

**优点：**
- 完整保留了原始数据的全部信息
- 不用考虑缺失值问题
- 未添加任何额外信息

**缺点：**
- 会大大增加数据的维度
- 计算量大大提升
- 只有在样本量非常大的时候效果才好

#### (5) 多重插补（Multiple Imputation, MI）
多重插补认为待插补的值是随机的，实践上通常是估计出待插补的值，再加上不同的噪声，形成多组可选插补值，根据某种选择依据，选取最合适的插补值。

#### (6) 手动插补
插补处理只是将未知值补以我们的主观估计值，不一定完全符合客观事实。在许多情况下，根据对所在领域的理解，手动对缺失值进行插补的效果会更好。

### 注意：插值方法

#### 拉格朗日插值法
- 基于多项式，通过构造一个经过所有已知点的多项式函数来预测未知点的值
- 将每个已知点构造成一个基本多项式，所有这些基本多项式的和形成了插值多项式
- 适用于小规模的插值问题
- 当插值点数增多时，计算和数值稳定性会变得复杂

#### 牛顿插值法
- 也是用多项式来预测未知点的值，但采用的是分差的形式
- 可以方便地添加新的插值点而不需要重新计算整个多项式
- 属于数值分析中的插值方法

## Step 3. 数据标准化

数据标准化是将样本的属性缩放到某个指定的范围。

### 数据标准化的原因

1. **某些算法要求样本具有零均值和单位方差**
2. **需要消除样本不同属性具有不同量级时的影响**：
   - 数量级的差异将导致量级较大的属性占据主导地位
   - 数量级的差异将导致迭代收敛速度减慢
   - 依赖于样本距离的算法对于数据的数量级非常敏感

### 标准化方法

#### Min-Max 标准化（归一化）
对于每个属性，设 minA 和 maxA 分别为属性 A 的最小值和最大值，将 A 的一个原始值 x 通过 min-max 标准化映射成在区间 [0,1] 中的值 x'。

**公式：**
```
新数据 = (原数据 - 最小值) / (最大值 - 最小值)
```

#### Z-Score 标准化（规范化）
基于原始数据的均值（mean）和标准差（standard deviation）进行数据的标准化。将 A 的原始值 x 使用 z-score 标准化到 x'。

**适用场景：**
- 适用于属性 A 的最大值和最小值未知的情况
- 有超出取值范围的离群数据的情况

**公式：**
```
新数据 = (原数据 - 均值) / 标准差
```