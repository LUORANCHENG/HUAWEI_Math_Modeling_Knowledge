# 随机森林在论文中的描述

## 摘要中的描述

集成随机森林和 XGBoost 两种机器学习模型同时训练和预测 5 种草原土壤化学性质, 分析了输入输出维度和结构,并建立了回归预测模型的评价指标。同时,为验证预测 算法的有效性,对随机森林、XGBoost 和支持向量机 (SVM) 3 种常见的预测方法 进行实现,进行模型对比。模型训练的过程中使用了交叉验证和网格搜索的方法保证 模型的最优化和健壮性。最终,虽然随机森林、XGBoost 和支持向量机模型预测的准 确程度都较好,但均明显弱于集成学习模型。因此,本题采用随机森林和 XGBoost 两种机器学习模型的集成学习模型对 2022 年锡林郭勒草原监测样地的 5 种草原土壤 化学性质进行预测。

根据**特征重要性理论**选取特 征,建立了基于**模拟退火算法**优化的**随机森林**模型,找到在不同降水量(300mm, 600mm、900 mm 和 1200mm)的情形下和草原沙漠化程度尽可能低的情况下最优的 放牧羊数量,作为可持续发展的放牧羊数量阈值,得出结论。

## 5.4 随机森林算法详细描述

随机森林是常用机器学习算法,它结合了多个决策树的输出以达到单个结果。它的易 用性和灵活性推动了它的采用,因为它可以处理分类和回归问题。

随机森林模型是由多棵决策树组成的。决策树从一个基本问题开始,这个问题构成了 树中的决策节点,作为分割数据的一种手段。每个问题都有助于个人做出最终决定,这将 由叶节点表示。符合标准的观察将遵循"是"分支,而那些不符合标准的将遵循备用路径。 决策树寻求找到对数据进行子集的最佳分割,它们通常通过分类和回归树(CART)算法 进行训练。诸如基尼不纯度(Gini Impurity)、信息增益或均方误差(MSE)等指标可用 于评估拆分的质量。

随机森林算法由决策树的集合组成,集成中的每棵树都由从训练集中抽取的具有替换的数据样本组成,称为引导样本。在该训练样本中,有三分之一留作测试数据,称为袋外(out-of-bag, oob)样本,我们稍后再讨论。然后通过特征装袋注入另一个随机性实例,为数据集增加更多多样性并减少决策树之间的相关性。根据问题的类型,预测的确定会有所不同。对于回归任务,单个决策树将被平均。对于分类任务,多数票,即最常见的分类变量将产生预测的类别。最后,oob 样本然后用于交叉验证,最终确定该预测。随机森林的训练流程如图 5-10 所示。

## 模型训练相关描述

针对数据集,分别建立随机森林、XGBoost、支持向量机(SVM)和随机森林与 XGBoost 的集成学习算法讲行建模,对每个模型均进行最优化参数选择,分别进行训练。

训练过程中,使用交叉验证和网格搜索的方法确保模型具有最佳的参数选择,也具有 良好的健壮性。

## 随机森林最佳参数选择

经过训练,分别对3种模型找到了最佳的参数组合,随机森林的最佳参数如表所示：

| 特征名            | 最佳取值 |
|----------------|------|
| n_estimators   | 110  |
| max depth      | 7    |
| min_samples_split | 5 |
| min_samples_leaf  | 7 |

## 模型对比评价

随机森林、XGBoost、支持向量机(SVM)和随机森林与 XGBoost 的集成学习算法这 4 种模型在测试集上的 R²、MSE、RMSE 和 MAPE 如表所示：

| 模型                  | R2     | MSE    | RMSE  | MAPE   |
|---------------------|--------|--------|-------|--------|
| 随机森林                | 0.542  | 15.499 | 3.936 | 8.606% |
| XGBoost             | 0.645  | 13.240 | 3.638 | 8.289% |
| 支持向量机               | 0.662  | 12.114 | 3.480 | 8.175% |
| 随机森林与 XGBoost 集成学习 | 0.687 | 11.973 | 3.460 | 8.039% |

可以看出,随机森林与 XGBoost 的集成学习模型在测试集上的 4 种评价指标的表现都 是最好的。

由图上的信息可以得知,随机森林与 XGBoost 集成学习模型在测试集上的拟合程度很好,不失为一种非常合适的模型,可以用于预测锡林郭勒草原监测样地(12个放牧小区) 在不同放牧强度下 2022 年土壤同期有机碳、无机碳、全氮 N、土壤 C/N 比的值。

## 随机森林与XGBoost集成学习模型的应用

保存训练好的随机森林与 XGBoost 集成学习模型,对 2022 年不同放牧强度下土壤同期有机碳、无机碳、全氮 N、土壤 C/N 比的值进行预测,得到下列结果。为了与给定的数据精度相同,预测结果保留 2 位小数。

## 模拟退火算法优化随机森林

### 数据预处理

将除降水量(mm)以外的上述气象信息数据、锡林郭勒草原土壤物理性质、化学性质和各放牧样地群落结构数据进行组合,形成了一张大的表格。由于后续准备使用模拟退火算法优化的随机森林方法进行降维,将这张大的表格按照随机森林的特征重要性方法,使用 SelectKBest 方法降维,得到一张处理后的表格,这张特征表格共有 35 项特征。

### 模型训练

根据 36 个特征值的最大值和最小值数据,将这些数值设置为模拟退火算法的取值上限和下限。模拟退火算法的开始温度设置为 100,结束温度设置为 1*10⁻⁶,模拟退火因子(SA Factor)选择 0.9, SA Link 的长度设置为 100。接下来,使用模拟退火算法优化随机森林模型的预测结果。

给定数据中的放牧强度按照题目中定义的对照(NG,0羊/天/公顷)、轻度放牧强度(LGI,2羊/天/公顷)、中度放牧强度(MGI,4羊/天/公顷)和重度放牧强度(HGI,8 羊/天/公顷)转换为数值。优化模型过程中,在模型的目标值沙漠化程度指数小于0.2(即题目定义的非沙漠化)的前提下,争取放牧羊数量达到最大。

使用网格搜索的方法调节参数,随机森林的参数选择如表所示：

| 参数名称               | 最佳取值 |
|-------------------|------|
| n_estimators      | 120  |
| max_depth         | 10   |
| min_samples_split | 3    |
| samples_leaf      | 3    |

运算过程中,模拟退火算法共筛选了 17500 组可能的取值,在第 8283 次优化时计算 出了模型的最好结果。

## 问题五小结

问题五首先对锡林郭勒盟典型草原不同年份、月份的气候数据进行分析,使用了热力 图等方法分析了气候数据的统计量和相关性。由于后续建模采用随机森林方法,使用随机 森林的特征重要性理论对数据进行降维,选取了 36 个特征。在模型实现上,采用了使用 模拟退火算法优化的随机森林算法,控制模型的目标值,即沙漠化程度指数小于 0.2 (题 目定义的非沙漠化),使得放牧羊数量达到最大。使用网格搜索的方法调节参数,选取最 佳模型。使用这一模型,输入 300mm、600mm、900mm 和 1200mm 降水量的数据,预测 了这些降水量的前提下放牧羊数量的最大阈值。将使用上述方法计算出的各降水量前提下 放牧羊数量的最大阈值作为问题五的结论。

## 问题三小结中的随机森林应用

问题三首先对锡林郭勒盟典型草原不同放牧强度土壤碳氮监测数据和轮牧放牧样地 群落结构监测数据进行分析,使用了柱状图、散点图、热力图等方法分析了化学性质数据 的统计量和相关性,并使用数据透视表将轮牧放牧样地群落结构监测数据转换成合适的格式,对空值进行填充,扩充了数据集的特征丰富程度。使用主成分分析(PCA)方法对数据进行降维。在模型实现上,采用了随机森林、XGBoost、支持向量机(SVM)和随机森林与XGBoost 的集成学习算法共3种方法,分别使用网格搜索的方法调节参数,选取最佳模型,在测试集上使用上述3种方法分别使用4种回归预测的评价指标(MSE、RMSE、R²和 MAPE)进行对比分析,并使用交叉验证的方法确保评价指标的真实性和模型的健壮性,对模型进行检验,得出随机森林与XGBoost集成学习模型的准确性最高的结论。因此,将使用该方法得出的锡林郭勒草原监测样地(12个放牧小区)在不同放牧强度下 2022 年土壤同期有机碳、无机碳、全氮 N、土壤 C/N 比的值作为问题三的结论。

## 模型优点中关于随机森林的评价

(1)本文采用了较为创新的模型方法,以深度学习神经网络为主导,分别建立了带有注意力机制的双向长短时记忆网络(Attention-BiLSTM)、随机森林和 XGBoost 的集成学习模型以及模拟退火算法优化的随机森林模型等创新性的算法,在 R²、MSE、MAE、MAPE 等各项指标上都取得了较好的检验效果,并且目前使用上述几种模型的方法进行放牧策略的研究甚少,也是本文提出的一大创新点。

(2)针对样本较为复杂的问题,从数据本身和统计学的角度,本文建立多种机器学习模型求解问题,例如使用随机森林、XGBoost、支持向量机(SVM)等方法建立回归预测模型 对草原土壤物理或化学性质进行预测,并且提出了集成学习模型的方式以改善预测效果, 明显优于传统的机器学习模型,这也是本文的一大亮点。 