# 滑动窗口在论文中的描述

## 摘要部分的描述

**对未来不同深度的土壤湿度的预测(问题二)**,本题结合给定的土壤湿度数据、 土壤蒸发数据和降水等数据变量,并选取相应的**时间序列预测**回归模型进行求解。首 先假设保持目前放牧策略不变,不同深度土壤湿度具有时序特征,使用**滑动窗口**的原 理进行时间序列划分,建立监督学习回归分析的数据,尝试建立 **BP 神经网络**模型, 但将题目所给数据代入后得出全连接的神经网络模型在已给数据中划分的测试集上 的拟合度较低、误差较大;为提高模型预测准确度,本题又建立了**长短时记忆网络** (LSTM)模型与带有注意力机制的双向长短时记忆网络(Attention-BiLSTM)模型 预测 2022 年、2023 年不同深度的土壤湿度。经过超参数优化和模型对比后得出 Attention-BiLSTM 模型在测试集的 R<sup>2</sup>、MSE、MAE、MAPE 各项指标都明显好于 其他神经网络,因此本题采用 R<sup>2</sup>为 0.88 的 Attention-BiLSTM 模型,得出 2022 年、 2023 年不同深度的结论。

## 问题提出部分的描述

问题二:问题二要求根据给定的土壤湿度数据、土壤蒸发数据和降水等数据变量, 选取相应的进行求解预测。面对大量样本大量数据的情况,需要寻找适合于时间序列 预测的数据挖掘技术,选择训练集和测试集对预测模型进行训练和测试,得出未来 2022年、2023年不同深度土壤湿度的预测结果。根据时序特征,使用滑动窗口进行 时间序列划分,形成监督学习回归分析的数据,并建立模型,经过训练和预测,得出 2022年、2023年不同深度土壤湿度,填写表格。

## 问题二分析与思路中的描述

我们发现,土壤湿度数据、土壤蒸发数据和降水等数据变量有时间序列的特征,具有 时序特点的数据集通常需要使用滑动窗口将时序数据转换成监督学习的数据集。本问题的 目标就是找到影响土壤部分物理性质内部隐含的时序特征,预测未来的土壤湿度。本文运 用相关性分析、长短时记忆网络(LSTM)模型与带有注意力机制的双向长短时记忆网络 (Attention-BiLSTM)等方法,结合文献综合建模。确定 2022 年、2023 年不同深度的土壤 湿度。

## 滑动窗口转换的详细描述

#### 4.2.5 滑动窗口转换

由于获取的锡林郭勒草原土壤物理性质数据是一系列时间序列数据,为了解决时间序 列预测问题,需要提取土壤物理性质数据的时间序列特征。这个操作完成后,模型对数据 的理解就会遵循时序规律。由于时间序列的特点,滑动窗口用于将土壤物理性质观测值转 换为监督学习数据集。根据这一分析和设计,使用滑动窗口的原理对数据进行处理,其原 理如图 4-14 所示。

从土壤物理性质数据表的开始,滑动窗口将前 n-1 个观测记录作为输入特征 fea<sub>1</sub>,将 时间 n 对应的观测记录作为对应的目标值 tar<sub>1</sub>。然后,向前移动一步,并执行相同的操作 以获得 fea,和 tar<sub>2</sub>。重复上述步骤,直到最后一组观测值成为目标表的最后一组目标值。

因此,将时间序列中的土壤物理性质数据转换为监督学习数据集后,该监督学习数据 集的每一行的特征值为第 *t-n* 个到第 *t-*1 个时间戳的观测记录,目标值为在第 *t* 个时间戳的 观测记录。

## 滑动窗口长度选择的描述

输入模型的表的特征数量由滑动窗口的长度 n 决定,这意味着调整 n 会影响模型的训练效果。因此,除了改变模型的超参数外,还需要仔细选择和调整之前预处理阶段的滑动窗口大小,以使模型发挥最佳精度,如图 4-20 所示。

## 模型对比中的滑动窗口长度

对 BP 神经网络、LSTM 网络和 Attention-BiLSTM 网络分别按照上述步骤进行训练和在测试集上的预测后,3种模型的最佳超参数选择和最佳滑动窗口长度分别如表 4-4~表 4-6 所示。

**BP 神经网络的最佳滑动窗口长度：68**

**LSTM 网络的最佳滑动窗口长度：48**

**Attention-BiLSTM 网络的最佳滑动窗口长度：72**

## 问题小结中的描述

问题二首先对锡林郭勒草原土壤物理性质数据进行分析,使用了箱线图、直方图、热力图等方法分析了物理性质数据的统计量和相关性,对重复数据与无效数据进行删除,保证剔除后剩余数据的可用性。针对数据的时序特征,用滑动窗口方法将时间序列数据转换为监督学习数据集。在模型实现上,采用了 BP 神经网络、LSTM 网络和 Attention-BiLSTM 网络方法,分别调节超参数,选取最佳模型,并在测试集上使用上述 3 种方法分别使用 4 种回归预测的评价指标(MSE、RMSE、R<sup>2</sup>和 MAPE)进行对比分析,对模型进行检验,得出 Attention-BiLSTM 网络的准确性最高。因此,将使用该方法得出的 2022 年、2023 年不同深度的土壤湿度作为问题二的结论。 