# BP神经网络在论文中的描述

## BP神经网络概述

BP(Back Propagation,反向传播)神经网络是神经网络中较为基础的网络,是一种按误差逆传播算法训练的多层神经网络,利用梯度搜索技术使得网络的输出值和实际输出值的误差均方差最小。

其中,误差采用逆传播,输出结果采用正向传播。逆传播指 BP 神经网络利用输出后的误差向上一个输入层反传,以调整前输入层的权值和阈值使误差最小。BP 神经网络模型包括输入层、隐藏层和输出层。

一个输入为 d 维变量和输出为 l 维的 BP 神经网络模型如图 4-15 所示。图中的隐藏层实际建模的时候可以有多层。

在图中,输入层单元到隐藏层单元的通道权重由v表示,例如输入层第i个单元到隐藏层第h个单元的信息通道为v<sub>ih</sub>。隐藏层单元到输出层单元的信息通道权重由*w*表示。例如隐藏层第h个单元到输出层第*j*个单元的信息通道权重为*w<sub>hj</sub>*。由于其对非线性关系较强的映射能力,在求解函数逼近问题、模式识别、分类以及数据压缩领域都被研究者们广泛使用。

## BP神经网络训练过程

首先,定义一个有 n 个神经元的输入层、p 个神经元的隐含层、q 个神经元的输出层。定义向量如下表 4-3 所示。

|向量名|解释|定义|
|---|---|---|
|输入向量|样本特征值特征个数|x|
|隐藏层输入向量|隐藏层与输出层连接权值|${\cal V}_{ih}$|
|隐藏层输出向量|隐藏层各神经元的阈值|$\theta_{hj}$|
|输出向量|样本目标值特征个数|У|

首先,需要将 BP 神经网络进行初始化,给各层级结点及连接权值赋初值,一般初值是取在-1 和1之间的随机数。设定误差函数 e、计算精度值*ε*和最大学习次数 M。

然后,随机选择若干个样本作为输入,并输入其原本对应的期望输出。对于隐含层,计算其对应的神经元个数及输入和输出,通过神经网络中输出的数据和实际真实数据进行对比,计算误差函数并得到输出层神经单元的偏导数。若输出层误差满足最小误差要求则结束,若不满足则还需要计算隐含层单元误差及其神经单元偏导数,再结合输出层神经单元偏导数修正连接权值。重复以上步骤,直到误差达到神经网络预设的精度ε或着超过最大学习次数 M,结束算法过程

## 在问题二中的应用

**对未来不同深度的土壤湿度的预测(问题二)**,本题结合给定的土壤湿度数据、土壤蒸发数据和降水等数据变量,并选取相应的**时间序列预测**回归模型进行求解。首先假设保持目前放牧策略不变,不同深度土壤湿度具有时序特征,使用**滑动窗口**的原理进行时间序列划分,建立监督学习回归分析的数据,尝试建立 **BP 神经网络**模型,但将题目所给数据代入后得出全连接的神经网络模型在已给数据中划分的测试集上的拟合度较低、误差较大;为提高模型预测准确度,本题又建立了**长短时记忆网络**(LSTM)模型与带有注意力机制的双向长短时记忆网络(Attention-BiLSTM)模型预测 2022 年、2023 年不同深度的土壤湿度。经过超参数优化和模型对比后得出 Attention-BiLSTM 模型在测试集的 R<sup>2</sup>、MSE、MAE、MAPE 各项指标都明显好于其他神经网络,因此本题采用 R<sup>2</sup>为 0.88 的 Attention-BiLSTM 模型,得出 2022 年、2023 年不同深度的结论。

## BP神经网络最佳参数

在问题二的模型对比中，BP神经网络的最佳超参数和最佳滑动窗口长度如下：

|名称|取值|
|---|---|
|隐藏层数|4|
|隐藏层1神经元数|128|
|隐藏层 2 神经元数|64|
|隐藏层 3 神经元数|64|
|隐藏层 4 神经元数|32|
|Batch size|64|
|Epoch|97|
|优化器|RMSProp|
|滑动窗口长度|68|

## 模型评价结果

在问题二的模型对比中，3种模型在测试集上的评价指标如下：

|模型|R2|MSE|RMSE|MAPE|
|---|---|---|---|---|
|BP 神经网络|0.477|17.581|4.193|7.939%|
|LSTM|0.556|15.729|3.966|7.289%|
|Attention-BiLSTM|0.716|10.074|3.174|5.540%|

可以看出,Attention-BiLSTM 在测试集上的4种评价指标的表现都是最好的。这是因为,双向LSTM 既可以捕捉正向的时间序列关系,也可以捕捉反向的时间序列关系;注意力机制可以让神经网络注意到哪些特征更加重要,从而为它们赋予更高的权重,提升预测的准确程度。 