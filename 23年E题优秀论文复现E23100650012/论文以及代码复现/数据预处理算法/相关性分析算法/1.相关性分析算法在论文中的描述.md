# 相关性分析算法在论文中的描述

## 1. 冗余特征过滤模型中的相关性分析

在经过方差分析剔除非显著性特征后,剩余 69 个变量。针对剩余变量的可视化结果, 发现部分变量的相关系数很高,具有高冗余性,因此,在本小节内,建立基于此的数学模型。

首先,根据本问的数据分布特点,选择适用的相关性系数计算方法。随后基于得到的 相关性系数矩阵,利用并查集的思想去除掉相关系数高的变量。常用的相关性系数矩阵法 主要包含 Pearson、Spearman、Kendall 三种典型算法,下面比较三种算法对本题的适用性。

### 皮尔逊相关系数

**皮尔逊相关系数**:也称积差相关系数,一般用于分析两个连续变量之间的关系。假设 变量 *x<sub>i</sub>* 和 *Y<sub>i</sub>*,皮尔逊相关系数用于度量 *x<sub>i</sub>* 和 *Y<sub>i</sub>*之间的线性相关程度,其公式为式 2:

$$r = \frac{\sum_{i=1}^{n} (x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \overline{x})^2} \sqrt{\sum_{i=1}^{n} (y_i - \overline{y})^2}}$$
(2)

Pearson 系数适用于:

(1) 两个变量之间是线性关系,都是连续数据;

(2) 两个变量的总体是正态分布,或接近正态的单峰分布;

(3) 两个变量的观测值是成对的,每对观测值之间相互独立。

### 斯皮尔曼相关系数

**斯皮尔曼相关系数**:又称秩相关系数,秩次指该样本在全部样本从小到大排序中所处的位置。当变量不服从正态分布,或者是分类、等级变量时,可以采用 Spearman 相关分析,其公式为式 3:

$$r = 1 - \frac{6\sum_{i=1}^{n} d_i^2}{n(n^2 - 1)}$$
(3)

其中 n 是样本的数量, d 代表数据之间的等级差。斯皮尔曼相关分析通过等级排序的 方式将数值转化为了等级排序,进而应用在非正态性的数据中进行相关性检验。

### 肯德尔相关系数

**肯德尔相关系数**:又称作和谐系数,是用来度量两个有序变量之间单调关系强弱的相关系数。计算公式如下式 4。

$$\tau = \frac{n_c - n_d}{\sqrt{(n_0 - n_1)(n_0 - n_2)}}$$
(4)

其中, *n<sub>C</sub>* 表示 **XY** 中拥有一致性的元素对数; *n<sub>d</sub>* 表示 **XY** 中拥有不一致性的元素对数。与前两种方法相比,其更适用于有序的变量。

### 算法选择结果

由于本题中的变量类型,还存在非连续型变量且不符合正态分布特性,因此选择斯皮尔曼系数进行冗余特征过滤数学建模。对于整理后的 69 个变量进行相关性检验,计算两两之间的斯皮尔曼系数,得到变量的相关性系数矩阵 C。随后利用并查集消除高相关变量。

## 2. 水肿体积和检查时间的关联性分析

此外,我们对水肿体积和检查时间之间的关联性进行了探究,表8所示为相关性分析 结果。主要使用了皮尔森、斯皮尔曼、肯德尔相关性分析、灰色关联度分析和互信息检验 计算相关性分析。其中,不难发现水肿体积和检查时间之间不存在明显的线性相关性,故 可能考虑使用一些非线性的模型进行拟合。

| 相关性分析方法 | 相关系数数值               |
|---------|----------------------|
| 肯德尔相关性  | 0.04886082371019567  |
| 斯皮尔曼相关性 | 0.04632014682270336  |
| 皮尔森曼相关性 | -0.07091298177069853 |
| 灰色关联度   | 0.13774481517528825  |
| 互信息检验   | 0.011138606135594012 |

## 3. 血肿体积与水肿体积的相关性分析

在本问中,首先探究血肿体积与水肿体积之间的相关性, 研究是否存在相关关系。然后以三个亚组的代表性患者(sub013,sub015,sub099)为例,探 究血肿体积与水肿体积之间的关系。在相关性的探究中,血肿体积与水肿体积之间的相关 性系数为 0.47。

根据相关性系数的判断依据,当相关性系数 >0.8 时,认为两个变量之间强相关。而血 肿体积与水肿体积的相关性系数只达到了 0.47,认为二者不存在强相关,可以判断这两个 变量不符合线性相关。

## 4. 随访数据量化变量的相关性分析

为了探究相关变量的合理性和独立性,我们对这五个变量进行了相关性计算,使用的 是斯皮尔曼相关性系数,计算结果如图 21:

不难看出,变量之间存在着一定的独立性,其中,水肿和血肿的持续时间相关性较高, 这也验证了水肿和血肿的出现和消失存在一定的滞后性和关联性,与问题2的结论相同。 